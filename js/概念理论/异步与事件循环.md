# 异步与事件循环

 * js属于单线程，同一个时间只能做一件事。
 * 预备：宏任务、微任务、事件循环

## 任务队列

根据规范，事件循环是通过任务队列的机制来进行协调的。一个 Event Loop 中，可以有一个或者多个任务队列(task queue)，一个任务队列便是一系列有序任务(task)的集合；**每个任务都有一个任务源(task source)，源自同一个任务源的 task 必须放到同一个任务队列，从不同源来的则被添加到不同队列**。 setTimeout/Promise 等API便是任务源，而进入任务队列的是他们指定的具体执行任务。



## 流程

主线程产生宏任务，将宏任务加入队列末尾。
宏任务执行，产生微任务，将微任务加入当前宏任务的微任务队列。
宏任务执行，产生宏任务，将新的宏任务加入宏任务队列末尾。
宏任务执行完毕，开始执行当前宏任务下的微任务。
微任务执行完毕，开始执行下一个宏任务

## 引用

>   [第 10 题：常见异步笔试题](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/7)